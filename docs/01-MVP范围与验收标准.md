# MVP 范围与验收标准

> 本文档作为当前版本的范围基线使用。  
> 若产品进入下一阶段，请先更新本文，再变更接口与权限文档。

## 1. 本期做什么（MVP）

### 1.1 账号与鉴权

| # | 功能 | 验收条件 |
|---|------|---------|
| A1 | 用户名+密码注册 | 提交后新增 `role=registered` 用户，密码以 bcrypt 哈希存储 |
| A2 | 用户名+密码登录 | 登录成功后写入 HttpOnly Cookie，默认跳转 `/invite` |
| A3 | 邀请码验证 | 有效邀请码提交后，`role: registered -> student`，并写入使用记录 |
| A4 | 邀请码失败处理 | 无效/过期/超限时返回对应错误，角色不变 |
| A5 | 登录防刷 | 同一 IP 每小时失败超过 20 次后返回 429 |
| A6 | 退出登录 | 退出后 Cookie 清除，访问受限页重定向 `/login` |

### 1.2 路由访问控制

| # | 功能 | 验收条件 |
|---|------|---------|
| B1 | 公开页可访问 | 未登录访问 `/`、`/course`、`/about`、`/faq`、`/login`、`/register` 均可显示 |
| B2 | 未登录拦截 | 未登录访问 `/rules`、`/reading`、`/tools`、`/interact`、`/homework`、`/resources`、`/discussion` 重定向 `/login` |
| B3 | registered 重定向 | `registered` 访问受限页重定向 `/invite` |
| B4 | invite 页可达 | `registered` 访问 `/invite` 可正常显示，不发生重定向死循环 |
| B5 | student 可访问 | `student` 可访问全部学员区内容 |
| B6 | 管理页拦截 | `student` 访问 `/admin/*` 重定向首页 |
| B7 | 管理页可用 | `teacher`/`admin` 可访问管理页；`/admin/users`、`/admin/invites` 仅 `admin` 可用 |

### 1.3 课程内容

| # | 功能 | 验收条件 |
|---|------|---------|
| C1 | 首页 | 展示课程价值、CTA、课程亮点，移动端可用 |
| C2 | 课程总览 | 展示 2+8+15 课程结构地图 |
| C3 | 关于与报名 | 展示课程简介、报名方式、常见入口 |
| C4 | FAQ | 展示常见问答 |
| C5 | 议事规则模块 | 展示两次课核心内容（十二条、动议流程、案例） |
| C6 | 工具库 | 展示 15 个思考工具目录与说明 |
| C7 | 资源中心 | 可下载模板（议程、纪要、主持脚本等） |
| C8 | 阅读探究 | 阅读站先整体嵌入，统一登录后可访问 |

### 1.4 课堂互动

| # | 功能 | 验收条件 |
|---|------|---------|
| D1 | 创建课堂 | 教师创建课堂后 `status=pending` |
| D2 | 开始/结束课堂 | 教师可切换 `pending -> active -> ended` |
| D3 | 举手队列 | 学员举手入队，教师端实时可见 |
| D4 | 发言计时 | 教师指定发言人并倒计时，全员可见 |
| D5 | 投票 | 支持单选/多选（可选匿名），教师可关闭并查看统计 |
| D6 | 30 人稳定 | 30 客户端同课堂下，关键互动事件端到端延迟目标 < 3 秒 |

### 1.5 课后闭环

| # | 功能 | 验收条件 |
|---|------|---------|
| E1 | 作业提交 | 学员可提交文本/附件，状态为 `submitted` |
| E2 | 作业查看 | 学员可查看本人作业历史 |
| E3 | 反馈问卷 | 学员可提交课程反馈 |
| E4 | 留言讨论 | 学员可发帖/评论，发布即显示 |
| E5 | 事后治理 | 教师/管理员可删除/隐藏内容并写入治理日志 |

### 1.6 管理后台

| # | 功能 | 验收条件 |
|---|------|---------|
| F1 | 学员列表 | 可按角色筛选，显示注册时间 |
| F2 | 角色管理 | 可设置 `registered/student/teacher/admin/blocked` |
| F3 | 邀请码生成 | 支持有效期、最大使用次数 |
| F4 | 邀请码列表 | 显示使用情况（`used_count/max_uses`） |
| F5 | 作业与反馈管理 | 教师/管理员可查看并导出 |
| F6 | 留言治理 | 教师/管理员可删除/隐藏并查看治理日志 |

---

## 2. 本期不做什么

| 功能 | 原因 |
|------|------|
| 视频直播/录播 | 超出 MVP 范围 |
| 支付/收费 | 当前业务阶段不需要 |
| 微信小程序 | 统一采用响应式 Web |
| 微信扫码登录 | 需企业资质，当前不作为首发路径 |
| 手机号短信登录（首发） | 短信审核与成本因素，放到 MVP+1 |
| 账号绑定（手机号与用户名合并） | 后续迭代 |
| 学习进度可视化看板 | 后续迭代 |
| AI 助教 | 后续迭代 |

---

## 3. MVP+1（增强项）

| 功能 | 前置条件 |
|------|---------|
| 手机号+短信验证码登录 | 阿里云短信签名与模板审核通过 |
| 账号绑定 | 完成账号合并与冲突处理策略 |
| 阅读笔记/批注 | 阅读站第二阶段重构完成 |

---

## 4. 技术验收

| # | 验收条件 |
|---|---------|
| T1 | `npm run build` 成功 |
| T2 | `npx drizzle-kit push` 成功 |
| T3 | 核心页面在 Chrome / Safari / 微信内置浏览器可用 |
| T4 | 375px 与 1440px 宽度下布局正常 |
| T5 | SQLite 每日自动备份可执行并可恢复 |
| T6 | HTTPS 生效，全站强制 HTTPS |
| T7 | Docker 部署方式可用（`docker compose up -d` 后站点可访问） |
